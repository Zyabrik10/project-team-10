function e(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},n={},i=t.parcelRequire0688;null==i&&((i=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var i={id:e,exports:{}};return o[e]=i,t.call(i.exports,i,i.exports),i.exports}var d=Error("Cannot find module '"+e+"'");throw d.code="MODULE_NOT_FOUND",d}).register=function(e,t){n[e]=t},t.parcelRequire0688=i);var d=i.register;d("ciXGU",function(t,o){e(t.exports,"ModalWindow",function(){return i("fERhu").default}),i("fERhu")}),d("fERhu",function(t,o){e(t.exports,"default",function(){return n});class n{constructor(e){if(this.modalId=e,this.mw=document.getElementById(this.modalId),!this.mw)throw Error(`No ${this.modalId} element was found`);this.hideModalWindowOnEscapeEnv=this.hideModalWindowOnEscape.bind(this),this.openModalWindowButtonHandler=this.showModalWindow.bind(this),this.openModalWindowButtons=[]}init(e){this.initCloseModalWindow(),this.initOpenButtons(e)}initCloseModalWindow(){if(this.closeModalWindowButton=this.mw.querySelector('button[data-role="close"]'),!this.closeModalWindowButton)throw Error('No button[data-role="close"] element was found');this.closeModalWindowButton.addEventListener("click",this.hideModalWindow.bind(this)),this.mw.addEventListener("mousedown",({target:e,currentTarget:t})=>{e===t&&this.hideModalWindow()})}initOpenButtons(e){this.openModalWindowButtons.forEach(e=>{e.removeEventListener("click",this.openModalWindowButtonHandler)}),this.openModalWindowButtonHandler=(async function(t){t.preventDefault(),"function"==typeof e&&await e(t,this),this.showModalWindow()}).bind(this),this.openModalWindowButtons=document.querySelectorAll(`[data-modal-id="${this.modalId}"]`),this.openModalWindowButtons.forEach(e=>{e.addEventListener("click",this.openModalWindowButtonHandler)})}hideModalWindow(){this.mw.classList.remove("active"),window.removeEventListener("keydown",this.hideModalWindowOnEscapeEnv),document.documentElement.style.overflow="auto"}hideModalWindowOnEscape({key:e}){"Escape"===e&&this.hideModalWindow()}showModalWindow(){this.mw.classList.add("active"),window.addEventListener("keydown",this.hideModalWindowOnEscapeEnv),document.documentElement.style.overflow="hidden"}}});var a=i("bi9oi");i("ciXGU");var s=i("fERhu"),l=i("2GpPp");(async()=>{let e=new(0,s.default)("registration-modal");e.init();let t=document.querySelector('#registration-modal .forms form[data-role="signin"]'),o=document.querySelector('#registration-modal .forms form[data-role="login"]'),n=document.querySelectorAll(".header-auth-buttons"),i=document.querySelectorAll('button[data-role="logout"]'),d=document.querySelectorAll(".header-shopping-cart-number");(0,a.onUserLoggedIn)(async t=>{if(t){let o=await (0,a.getUserById)(t.uid);d.forEach(e=>e.innerText=o.favBooks.length),e.hideModalWindow(),(0,l.localStorageSetItem)("user-id",t.uid),(0,l.localStorageSetItem)("user-fav-books",o.favBooks),n.forEach(e=>e.classList.add("active"))}else n.forEach(e=>e.classList.remove("active")),(0,l.localStorageSetItem)("user-id",""),(0,l.localStorageSetItem)("user-fav-books",""),d.forEach(e=>e.innerText=0)}),t.addEventListener("submit",async e=>{e.preventDefault();let o={username:t.username.value.trim(),email:t.email.value.trim(),password:t.password.value.trim(),favBooks:[]};await (0,a.signup)(o)}),o.addEventListener("submit",async e=>{e.preventDefault();let t={email:o.email.value.trim(),password:o.password.value.trim()};await (0,a.signin)(t)}),i.forEach(e=>e.addEventListener("click",()=>{(0,a.logout)()}))})();
//# sourceMappingURL=project-team-10.ba360a66.js.map
